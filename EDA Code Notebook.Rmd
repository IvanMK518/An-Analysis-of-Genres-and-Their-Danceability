---
title: "R Notebook"
output: html_notebook
---

Components of Analysis (from canvas, basically the rubric for the assignment)
* Introducing the dataset (including its source, scope, and any ethical considerations) framed by the purpose of the exploratory analysis, anticipating any subsetting or re-ordering of the data for your interests
* Reading the data into R in a tabular format, identifying, subsetting, and renaming the variables for your use
* Forming the core data frame that you'll be working from by reshaping and summarizing the data, storing new data frames in memory where appropriate
* Cleaning the data according to your purpose for the dataset
* Plotting distributions of your data
* Calculating basic statistical metrics like central tendency measures
* Some light correlational analysis/visualization of key variables.
* A look forward to what further questions the analysis suggests and what it enables

# Music Dataset : 1950 to 2019

## Introduction

In a nutshell, our dataset collects music produced from 1950 to 2019, fetched from Spotify. We obtained the dataset from Kaggle (DOI: 10.17632/3t9vbwxgr5.3), where the description said, "This dataset provides a list of lyrics from 1950 to 2019 describing music metadata as sadness, danceability, loudness, acousticness, etc. Authors also provide some information as lyrics which can be used to natural language processing." Our purpose TKTK (after we decide on the question to support further exploration).

We first load the dataset and the tidyverse package in preparation for further exploration.

```{r}
# Set CRAN mirror and install necessary packages
options(repos = c(CRAN = "https://cran.rstudio.com"))

install.packages("evaluate")
install.packages("renv")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("magrittr")

# Snapshot, restore, and hydrate renv environment
renv::snapshot()
renv::restore()
renv::hydrate()

# Load necessary libraries
library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)
library(magrittr)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
renv::snapshot()
renv::restore()
renv::hydrate()
```

```{r}
install.packages("tidyverse")
library(tidyverse)
```

```{r}
library(readr)
music <- read_csv("/Users/ivanmartinez-kay/QTM-302W/Data/music.csv") 
```


We then apply head(), str(), and summary() to obtain an overview of the dataset.

```{r}
#Print the first 6 observations
head(music)
```

```{r}
#Review the structure of the dataset
str(music)

# Print the column names to confirm
print(names(music))
```

```{r}
#Review the summary of the data
summary(music)
```

```{r}
# Subset the dataset with the variables of interest
data <- music[ ,c("genre", "loudness", "energy", 
"danceability", "feelings", "instrumentalness", "lyrics")]
```

```{r}
library(dplyr)

# Calculate median danceability by genre
median_danceability_by_genre <- data %>%
  group_by(genre) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Print the median danceability by genre
print(median_danceability_by_genre)
```

```{r}
# Load necessary libraries
library(readr)
library(ggplot2)

# Create a bar chart of median danceability by genre
ggplot(median_danceability_by_genre, aes(x = genre, y = median_danceability)) +
  geom_bar(stat = "identity", fill = "blue") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Genre",
       x = "Genre",
       y = "Median Danceability")
```

```{r}
library(dplyr)

# Calculate median danceability by genre
median_danceability_by_feeling <- data %>%
  group_by(feelings) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Print the median danceability by genre
print(median_danceability_by_feeling)
```

```{r}
library(readr)
library(ggplot2)

# Bins to condense data of musical feel 
num_bins <- 20 
data <- data %>%
  mutate(feeling_bin = cut(feelings, breaks = num_bins))

# Calculate median danceability by feel of music
median_danceability_by_feeling_bin <- data %>%
  group_by(feeling_bin) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Bar chart of median danceability by feel
ggplot(median_danceability_by_feeling_bin, aes(x = feeling_bin, y = median_danceability)) +
  geom_bar(stat = "identity", fill = "blue") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Feel",
       x = "Feel",
       y = "Median Danceability")
```

```{r}
library(dplyr)

# Calculate median danceability by genre
median_danceability_by_instrumentalness <- data %>%
  group_by(instrumentalness) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Print the median danceability by genre
print(median_danceability_by_instrumentalness)
```

```{r}
# Create bins for the instrumentalness variable
num_bins <- 20 
data <- data %>%
  mutate(instrumentalness_bin = cut(instrumentalness, breaks = num_bins))

# Calculate median danceability by instrumentalness bin
median_danceability_by_instrumentalness <- data %>%
  group_by(instrumentalness_bin) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Bar chart of median danceability by instrumentality
ggplot(median_danceability_by_instrumentalness, aes(x = instrumentalness_bin, y = median_danceability)) +
  geom_bar(stat = "identity", fill = "blue") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Instrumentality",
       x = "Instrumentality",
       y = "Median Danceability")
```

```{r}
# Bins for condensing data inthe feelings and instrumentalness variables
num_bins_feelings <- 2
num_bins_instrumentalness <- 2

data <- data %>%
  mutate(feeling_bin = cut(feelings, breaks = num_bins_feelings),
         instrumentalness_bin = cut(instrumentalness, 
         breaks = num_bins_instrumentalness))

# Calculate median danceability by genre, feelings bin, and instrumentalness bin
median_danceability_by_genre_feeling_instrumentalness <- data %>%
  group_by(genre, feeling_bin, instrumentalness_bin) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Create a bar chart of median danceability by genre, feelings bin, and instrumentalness bin
ggplot(median_danceability_by_genre_feeling_instrumentalness, aes(x = interaction(feeling_bin, 
instrumentalness_bin), y = median_danceability, fill = genre)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Genre, Feeling, and Instrumentalness",
       x = "Feeling and Instrumentalness",
       y = "Median Danceability",
       fill = "Genre")
```
```{r}
# Bins for condensing the data in feelings and instrumentalness variables
num_bins_feelings <- 4
num_bins_instrumentalness <- 4

data <- data %>%
  mutate(feeling_bin = cut(feelings, breaks = num_bins_feelings),
         instrumentalness_bin = cut(instrumentalness, 
         breaks = num_bins_instrumentalness))

# Calculate median danceability by genre, feelings bin, and instrumentalness bin
median_danceability_by_genre_feeling_instrumentalness <- data %>%
  group_by(genre, feeling_bin, instrumentalness_bin) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

# Scatter plot with wider variety of data points
ggplot(median_danceability_by_genre_feeling_instrumentalness, aes(x = interaction(feeling_bin, 
instrumentalness_bin), y = median_danceability, color = genre)) +
  geom_point(size = 3) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Genre, Feeling, and Instrumentalness",
       x = "Feeling and Instrumentalness",
       y = "Median Danceability",
       color = "Genre")
```
```{r}
library(dplyr)

# Calculate median danceability by decibel level
median_danceability_by_loudness <- data %>%
  group_by(loudness) %>%
  summarise(median_danceability = median(danceability, na.rm = TRUE))

print(median_danceability_by_loudness)
```

```{r}
library(readr)
library(ggplot2)

# Bar chart of median danceability by decibel level
ggplot(median_danceability_by_loudness, aes(x = loudness, y = median_danceability)) +
  geom_bar(stat = "identity", fill = "blue") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Median Danceability by Loudness",
       x = "Loudness (Db)",
       y = "Median Danceability")
```

Below are what we notice about the music dataset after some basic exploration:

* The head() function gives us a close look at the rows and the columns of the dataset. The rows tell us that the dataset contains 28,372 songs, with each row corresponding to one specific song. The first seven columns provide each listed song with (I'm not sure what the first row is about, maybe we can delete it) the artist's name, the song's name, the release date, the genre, a few lines of lyrics, and the length of the song (measured in seconds). 

* Aside from the above mentioned 7 columns that provide the basic identification of the listed songs, the remaining columns meansure each song on 24 different dimensions. Some examples include (the following is from the paper based on this dataset, I will paraphrase them later)
  * Acousticness: Presence of acoustic instruments
  * Danceability: how suitable a track is for dancing based on a combination of musical elements including tempo, rhythm stability, beat strength, and overall regularity
  * Loudness: The average loudness in decibels (dB) across the entire track
  * Instrumentalness: A high value describes whether a track contains fewer vocals
  * Valence: High (low) values means that the track is more happy, euphoric (sad, angry)
  * Energy: Measures intensity and activity of music. Energetic tracks will be fast, loud and noisy

* The str() function then gives us the variable types included in the dataset. The majority of the variables possess the form of numbers, followed by some characters. Finally, the summary() function provides us with all the statistical measurements of the variables. (We can further discuss some interesting tendency/outliers here, leading to the question we wanna prpose for further exploration.)